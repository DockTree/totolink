# TOTOlink A7100RU(V7.4cu.2313_B20191024)路由器存在命令注入漏洞
## 基本信息
厂商信息：http://totolink.net/

固件下载地址：http://totolink.net/home/menu/detail/menu_listtpl/download/id/185/ids/36.html

## 1. 影响版本
V7.4cu.2313_B20191024

## 2. 漏洞细节
在set分支里面存在setWizardCfg的函数
![](https://github.com/DockTree/totolink/blob/main/main.png)
在这个函数里面用户通过输入pptpIp传入staticip值
而staticIp会进入Uci-Set-Str函数
![](https://github.com/DockTree/totolink/blob/main/StaticIp.png)
这个函数存在着命令执行的漏洞，通过$()绕过双引号实现命令执行
![](https://github.com/DockTree/totolink/blob/main/Uci-Set-Str.png)

## 3. 漏洞实现效果
![](https://github.com/DockTree/totolink/blob/main/curl.png)

![](https://github.com/DockTree/totolink/blob/main/result.png)
